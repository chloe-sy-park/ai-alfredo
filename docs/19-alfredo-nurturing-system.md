# 🐧 알프레도 육성 시스템 설계

> **핵심 철학**: "설정"이 아니라 "육성". 유저가 알프레도를 자신만의 스타일로 키워간다.

---

## 1. 육성의 3가지 층위

| 층위 | 설명 | 유저 액션 |
|------|------|----------|
| **자동 학습** | 알프레도가 알아서 배움 | 없음 (그냥 살기) |
| **직접 조율** | 유저가 스타일 선택 | 슬라이더 조절 |
| **함께 성장** | 시간 지나며 서로 맞춰감 | 피드백 주기 |

---

## 2. 4가지 육성 축

### 2-1. 말투
- 🌸 다정하게 ↔ 🔥 직설적으로
- 다정: "힘들 수 있으니까 쉬어가요, 괜찮죠?"
- 직설: "체력 관리 필수. 반드시 10분 휴식 넣으세요."

### 2-2. 알림 빈도
- 🤫 필요할 때만 ↔ 💬 자주자주

### 2-3. 데이터 깊이
- 😌 핵심만 ↔ 🔬 다 보여줘

### 2-4. 동기부여 방식
- 🌊 느긋하게 ↔ 🏆 도전적으로

---

## 3. 구현 현황 체크 (2025-01-12)

### Phase 1: 기본 육성

| 항목 | 상태 | 설명 |
|------|------|------|
| 4가지 축 슬라이더 | ❌ TODO | 말투, 알림빈도, 데이터깊이, 동기부여방식 |
| 실시간 프리뷰 | ❌ TODO | 슬라이더 움직이면 알프레도 말투 변화 보여주기 |
| "알프레도가 배운 것" 리스트 | ❌ TODO | DNA 프로파일은 있지만 사용자에게 보여주는 UI 없음 |
| 피드백 버튼 (좋아요/아니야) | ❌ TODO | 채팅에서 알프레도 제안에 피드백 주기 |

### Phase 2: 대화형 육성

| 항목 | 상태 | 설명 |
|------|------|------|
| 대화로 가르치기 | ❌ TODO | "아침엔 말 걸지 마" → 기억 |
| "기억해둘게요" 시스템 | ❌ TODO | 사용자 선호 저장 |
| 틀렸을 때 자연스러운 교정 | ❌ TODO | [아니, 오후엔 힘들어] 선택 → 학습 |

### Phase 3: 깊은 육성

| 항목 | 상태 | 설명 |
|------|------|------|
| 영역별 다른 스타일 | ❌ TODO | 업무=직설적, 라이프=다정하게 |
| 알프레도 이해도 레벨/칭호 | ⚠️ 다른 개념 | 현재는 "사용자 XP" 레벨, 문서는 "알프레도가 나를 이해하는 정도" |
| 주간 성장 리포트 | ❌ TODO | 이번 주 배운 것, 아직 파악 중인 것 |

### ✅ 관련해서 이미 구현된 것들

- DNA 확장 엔진 - 캘린더 기반 사용자 패턴 추론
- 게이미피케이션 - XP, 레벨, 배지, 퀘스트 시스템
- Claude API 채팅 - 실시간 AI 대화
- 컨디션 기반 반응 - 에너지/무드에 따른 말투 변화

---

## 4. 상세 설계

### 4-1. 알프레도 스타일 설정 UI

```
┌─────────────────────────────────────┐
│  🐧 내 알프레도 스타일               │
├─────────────────────────────────────┤
│                                     │
│  1. 말투는 어떻게?                  │
│  [🌸 다정하게] ─────●───── [🔥 직설적으로]
│                                     │
│  2. 얼마나 자주 말 걸까?            │
│  [🤫 필요할 때만] ───●───── [💬 자주자주]
│                                     │
│  3. 데이터는 얼마나?                │
│  [😌 핵심만] ─────────●─── [🔬 다 보여줘]
│                                     │
│  4. 동기부여 방식은?                │
│  [🌊 느긋하게] ───●─────── [🏆 도전적으로]
│                                     │
└─────────────────────────────────────┘
```

### 4-2. 실시간 프리뷰

슬라이더 움직이면 알프레도가 실시간으로 변함:

```
말투: 🌸 다정하게 ●─────────────────
                    ↓
┌─────────────────────────────────────┐
│  🐧 "오늘 미팅 3개나 있네요.        │
│      힘들 수 있으니까 중간에        │
│      잠깐 쉬어가요, 괜찮죠? 💙"     │
└─────────────────────────────────────┘

말투: ─────────────────────────● 🔥 직설적으로
                    ↓
┌─────────────────────────────────────┐
│  🐧 "오늘 미팅 3개. 체력 관리       │
│      필수입니다. 11시 미팅 후       │
│      반드시 10분 휴식 넣으세요."    │
└─────────────────────────────────────┘
```

### 4-3. 알프레도가 배운 것 리스트

```
┌─────────────────────────────────────┐
│  📚 알프레도가 배운 것들             │
├─────────────────────────────────────┤
│                                     │
│  ┌─────────────────────────────┐   │
│  │ 📌 "아침엔 말 걸지 마"       │   │
│  │    → 오전 10시 전 알림 안 함 │   │
│  │                     [수정]   │   │
│  └─────────────────────────────┘   │
│                                     │
│  ┌─────────────────────────────┐   │
│  │ 📌 "운동 약속은 절대 건드리지 마"│  │
│  │    → 🏃 일정은 이동 제안 안 함│   │
│  │                     [수정]   │   │
│  └─────────────────────────────┘   │
│                                     │
│  ┌─────────────────────────────┐   │
│  │ 📌 "월요일은 항상 힘들어"    │   │
│  │    → 월요일 브리핑 톤 부드럽게│   │
│  │                     [수정]   │   │
│  └─────────────────────────────┘   │
│                                     │
│  [+ 새로 가르치기]                  │
│                                     │
└─────────────────────────────────────┘
```

### 4-4. 대화로 가르치기

설정 화면 안 가도, 대화하면서 자연스럽게:

```
유저: "아 알프레도 아침에 알림 좀 그만 보내"

알프레도: "아, 미안해요! 😅
          아침엔 조용히 할게요.
          몇 시부터 말 걸어도 될까요?"

유저: "10시?"

알프레도: "알겠어요!
          오전 10시 전엔 조용히 있을게요.
          급한 것만 알려드릴게요 📝"

          [이렇게 기억했어요]
          • 오전 10시 전 알림 최소화
```

### 4-5. 피드백 버튼

```
┌─────────────────────────────────────┐
│  🐧 알프레도                        │
├─────────────────────────────────────┤
│                                     │
│  "오후 2시에 보고서 작업 어때요?    │
│   이 시간이 집중 잘 되는 것 같아서" │
│                                     │
│  [👍 좋아요] [👎 아니야]            │
│                                     │
└─────────────────────────────────────┘

↓ "아니야" 선택 시

┌─────────────────────────────────────┐
│  🐧 "아, 그렇구나!                  │
│      오후엔 좀 힘드시는구나.        │
│      기억해둘게요 📝                │
│                                     │
│      그럼 보고서는 언제가 좋을까요?"│
│                                     │
│  [오전이 좋아] [저녁에 할래] [내일] │
└─────────────────────────────────────┘
```

### 4-6. 알프레도 이해도 게이지

```
┌─────────────────────────────────────┐
│  🧠 알프레도가 당신을 이해하는 정도  │
├─────────────────────────────────────┤
│                                     │
│  ████████░░ 78% (+12% 이번 주)      │
│                                     │
│  ─────────────────────────────────  │
│                                     │
│  📚 이번 주 새로 배운 것            │
│  • "수요일 오후가 집중력 피크"      │
│  • "미팅 3개 넘으면 지침"           │
│  • "비 오는 날 재택 선호"           │
│                                     │
│  ❓ 아직 파악 중                    │
│  • 점심 후 에너지 패턴              │
│  • 주말 계획 스타일                 │
│                                     │
│  💬 "2주 더 같이 지내면 알 것 같아요"│
│                                     │
└─────────────────────────────────────┘
```

### 4-7. 영역별 다른 스타일

```
┌─────────────────────────────────────┐
│  🐧 영역별 알프레도 스타일          │
├─────────────────────────────────────┤
│                                     │
│  💼 업무 모드                       │
│  ┌─────────────────────────────┐   │
│  │ 말투: 🔥 직설적              │   │
│  │ 알림: 💬 자주                │   │
│  │ 동기부여: 🏆 도전적          │   │
│  │                             │   │
│  │ "업무는 칼같이 챙겨줘"       │   │
│  └─────────────────────────────┘   │
│                                     │
│  🧘 라이프 모드                     │
│  ┌─────────────────────────────┐   │
│  │ 말투: 🌸 다정하게            │   │
│  │ 알림: 🤫 필요할 때만         │   │
│  │ 동기부여: 🌊 느긋하게        │   │
│  │                             │   │
│  │ "쉴 땐 편하게 대해줘"        │   │
│  └─────────────────────────────┘   │
│                                     │
└─────────────────────────────────────┘
```

---

## 5. 알프레도 레벨 & 칭호 (선택적)

**게이미피케이션이지만 선택 가능:**
- 🏆 성과 지향형: 레벨, 칭호 보여줌
- 🌊 플로우형: 숨기기 가능 (Headspace 스트릭 숨기기처럼)

```
현재 레벨: Lv.12 🎖️
칭호: "당신의 리듬을 아는 펭귄"

████████████░░░░░░░░ 62%
→ 다음 레벨까지 38%

🏆 획득한 칭호들
Lv.1  "처음 만난 펭귄"
Lv.5  "이름을 기억하는 펭귄"
Lv.10 "당신의 아침을 아는 펭귄"
Lv.12 "당신의 리듬을 아는 펭귄" ← 현재
Lv.15 ???
Lv.20 ???
```

---

## 6. 데이터 구조 설계

### 6-1. alfredo_preferences 테이블

```sql
CREATE TABLE alfredo_preferences (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  user_id UUID REFERENCES users(id),
  
  -- 4가지 육성 축 (0-100)
  tone_warmth INTEGER DEFAULT 50,        -- 다정함 ↔ 직설적
  notification_freq INTEGER DEFAULT 50,  -- 필요시만 ↔ 자주
  data_depth INTEGER DEFAULT 50,         -- 핵심만 ↔ 전부
  motivation_style INTEGER DEFAULT 50,   -- 느긋 ↔ 도전적
  
  -- 영역별 오버라이드 (JSON)
  domain_overrides JSONB DEFAULT '{}',
  -- 예: {"work": {"tone_warmth": 30}, "life": {"tone_warmth": 80}}
  
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);
```

### 6-2. alfredo_learnings 테이블

```sql
CREATE TABLE alfredo_learnings (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  user_id UUID REFERENCES users(id),
  
  -- 배운 내용
  user_input TEXT NOT NULL,           -- "아침엔 말 걸지 마"
  learning_summary TEXT NOT NULL,     -- "오전 10시 전 알림 안 함"
  learning_type TEXT NOT NULL,        -- 'time_preference', 'task_preference', 'mood_pattern'
  
  -- 적용 규칙 (JSON)
  applied_rules JSONB NOT NULL,
  -- 예: {"notification_quiet_before": "10:00"}
  
  -- 신뢰도
  confidence FLOAT DEFAULT 0.5,       -- 0-1, 피드백으로 증가/감소
  feedback_count INTEGER DEFAULT 0,
  
  -- 출처
  source TEXT NOT NULL,               -- 'chat', 'feedback_button', 'settings'
  
  is_active BOOLEAN DEFAULT TRUE,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);
```

### 6-3. alfredo_understanding 테이블

```sql
CREATE TABLE alfredo_understanding (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  user_id UUID REFERENCES users(id),
  
  -- 이해도 점수
  understanding_score INTEGER DEFAULT 0,  -- 0-100
  level INTEGER DEFAULT 1,
  title TEXT DEFAULT '처음 만난 펭귄',
  
  -- 주간 배운 것들 (JSON)
  weekly_learnings JSONB DEFAULT '[]',
  -- 예: [{"text": "수요일 오후가 집중력 피크", "date": "2025-01-10"}]
  
  -- 아직 파악 중인 것들 (JSON)
  pending_learnings JSONB DEFAULT '[]',
  -- 예: [{"text": "점심 후 에너지 패턴", "data_needed": 5}]
  
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);
```

---

## 7. 구현 로드맵

### Phase 1: 기본 육성 (Week 1-2)

- [ ] `AlfredoStyleSettings.jsx` 컴포넌트
  - 4가지 축 슬라이더 UI
  - 실시간 프리뷰 패널
  - localStorage 저장

- [ ] `AlfredoLearnings.jsx` 컴포넌트
  - "알프레도가 배운 것" 리스트 UI
  - 수정/삭제 기능
  - "새로 가르치기" 모달

- [ ] 채팅에 피드백 버튼 추가
  - [👍] [👎] 버튼 UI
  - 피드백 저장 로직

### Phase 2: 대화형 육성 (Week 3-4)

- [ ] 대화로 가르치기 시스템
  - 자연어 파싱 ("아침엔 말 걸지 마")
  - 규칙 추출 → alfredo_learnings 저장
  - "기억해둘게요" UI 피드백

- [ ] 틀렸을 때 교정 플로우
  - 선택지 제공 (오전/저녁/내일)
  - 학습 업데이트

### Phase 3: 깊은 육성 (Week 5-6)

- [ ] 영역별 다른 스타일
  - 업무/라이프 모드 분리
  - 컨텍스트 기반 자동 전환

- [ ] 알프레도 이해도 시스템
  - 이해도 점수 계산 로직
  - 레벨/칭호 시스템
  - 주간 성장 리포트

---

## 8. 관련 문서

- [DNA 확장 엔진](./dna_expansion_engine_kr.md) - 캘린더 기반 암묵적 학습
- [03-tone-system.md](./03-tone-system.md) - 톤 시스템 설계
- [16-prompt-engineering.md](./16-prompt-engineering.md) - 프롬프트 엔지니어링

---

*마지막 업데이트: 2025-01-12*
